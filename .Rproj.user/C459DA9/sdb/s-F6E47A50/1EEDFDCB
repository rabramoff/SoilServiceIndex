{
    "contents" : "---\ntitle: \"Soil_Index_1stDraft\"\nauthor: \"Rose Abramoff\"\ndate: \"9/25/2017\"\noutput: html_document\n---\n#Load Workspace\n```{r}\nload(file=\"SoilIndex.Rdata\")\n```\n\n#Preliminary Index from 0-1\n```{r}\nEnterYourSOCValue <- 1000 #in gC/dm3 - same as kg/m3\nEnterYourNminValue <- 30 #in g/m2/yr for OA horizons\nEnterYourResPValue <- 10 #in mg P/kg\nSOCWeight <- 1\nNminWeight <- 0.5\nResPWeight <- 0.5\n\nW.Index(EnterYourSOCValue,EnterYourNminValue,EnterYourResPValue,SOCWeight,NminWeight,ResPWeight)\n```\n\n#Other scripts\n##Explore soil organic carbon data\n```{r}\nsummary(lay$orgc_value_avg)\nhist(lay$orgc_value_avg, xlim = c(0,100), breaks=100, xlab=expression(\"SOC (gC/kg)\"))\nhist(lay$bdws_value_avg) #bulk density of whole soil kg/dm3\n\nhist(lay$orgc_value_avg*lay$bdws_value_avg,  xlim = c(0,100), breaks=100, xlab=expression(\"SOC (gC/dm3)\"), main=\"Soil Organic Carbon\") #same as kg/m3\n\nsummary(lay$orgc_value_avg*lay$bdws_value_avg)\n#possible index by quartiles: 0-2.6 low, 2.6-6 med, 6-14.9 good, 14.9-1250 high\n\n#no land use type, but location and soil type\nsummary(df$cfao_soil_unit) #fao\nsummary(df$cfao_major_group)\nsummary(df$cstx_great_group) #soil tax\nsummary(df$cwrb_reference_soil_group) #world reference base\nsummary(df$cwrb_prefix_qualifier)\nsummary(df$cwrb_suffix_qualifier)\n\nrequire(ggplot2)\nlay$soc_estimate <- lay$orgc_value_avg*lay$bdws_value_avg\nggplot(lay, aes(soc_estimate)) +\n  geom_density()\n#takes a while:\n#ggplot(lay, aes(soc_estimate, fill=orgc_profile_code)) +\n#  stat_density(position=\"stack\")\n```\n\n##Explore N and P data\n```{r}\nsummary(as.numeric(as.character(nf$Nmin_g_m2_yr_O_mean)))\nsummary(as.numeric(as.character(nf$Nmin_g_m2_yr_A_mean)))\nsummary(as.numeric(as.character(nf$Nmin_g_m2_yr_OA_mean))) #g/m2/horizon\nsummary(pf$Resin.Pi) #mg P/kg\n\nhist(as.numeric(as.character(nf$Nmin_g_m2_yr_O_mean)), xlim = c(0,100), breaks=100, xlab=expression(\"Nmin (g/m2/y O horizon)\"))\nhist(as.numeric(as.character(pf$Resin.Pi)), xlim = c(0,200), breaks=100, xlab=expression(\"Resin P (mg/kg)\"))\n\nrequire(ggplot2)\nggplot(nf, aes(as.numeric(as.character(nf$Nmin_g_m2_yr_O_mean)))) +\n  geom_density()\nggplot(pf, aes(pf$Resin.Pi)) +\n  geom_density()\n\nggplot(nf, aes(NminNum, fill=LandUseType)) +\n  stat_density(position=\"stack\") +\n  xlim(-10,60) +\n  xlab(\"N mineralization (g/m2/y) - OA horizon\")\n```\n\n##Index Function\n```{r}\nSOCnums <- lay$orgc_value_avg*lay$bdws_value_avg\nSOCnums <- SOCnums[!is.na(SOCnums)] #remove NAs\nnf$NminNum <- as.numeric(as.character(nf$Nmin_g_m2_yr_OA_mean))\nNnums <- nf$NminNum[!is.na(nf$NminNum)] #remove NAs\nNnums <- Nnums[Nnums < 400 & Nnums > -200] #remove 2 outliers\nResP <- pf$Resin.Pi\n\nrange01 <- function(x){(x-min(x))/(max(x)-min(x))}\nrangeSOC <- function(x){(x-min(SOCnums))/(max(SOCnums)-min(SOCnums))}\nrangeNmin <- function(x){(x-min(Nnums))/(max(Nnums)-min(Nnums))}\nrangeResP <- function(x){(x-min(ResP))/(max(ResP)-min(ResP))}\n\n#SOCindex <- range01(SOCnums)\n#Nindex <- range01(Nnums)\n#Pindex <- range01(ResP)\n#plot(SOCindex)\n#plot(Nindex)\n#plot(Pindex)\n\nW.Index <- function(s,n,p,ws,wn,wp){\nSOCindex <- rangeSOC(EnterYourSOCValue)\nNindex <- rangeNmin(EnterYourNminValue)\nPindex <- rangeResP(EnterYourResPValue)\nwindex <- (SOCindex*ws + Nindex*wn + Pindex*wp)/3\nreturn(windex)\n}\n```\n",
    "created" : 1509123015704.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4237066401",
    "id" : "1EEDFDCB",
    "lastKnownWriteTime" : 1509135342,
    "path" : "~/Dropbox (Climate)/External Collaborations/ISCN/Soil_Index_2ndDraft.Rmd",
    "project_path" : "Soil_Index_2ndDraft.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}